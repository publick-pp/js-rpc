# JS-RPC

> **è®©è¿œç¨‹è°ƒç”¨åƒæœ¬åœ°å‡½æ•°ä¸€æ ·ç®€å•ã€‚**  
> Make remote calls as simple as local functions.

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

**JS-RPC** æ˜¯ä¸€ä¸ªä¸“ä¸º JavaScript å…¨æ ˆç”Ÿæ€è®¾è®¡çš„è½»é‡çº§ RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰è§£å†³æ–¹æ¡ˆã€‚

å®ƒæ‰“ç ´äº†å‰ç«¯ä¸åç«¯çš„è¾¹ç•Œï¼Œé€šè¿‡â€œçº¦å®šä¼˜äºé…ç½®â€çš„è®¾è®¡ç†å¿µï¼Œè®©æ‚¨åœ¨ å°ç¨‹åºã€Webã€Node.js ç­‰ä»»ä½• JS è¿è¡Œç¯å¢ƒä¸­ï¼Œéƒ½èƒ½äº«å—åˆ°æè‡´ä¸æ»‘çš„æ¥å£è°ƒç”¨ä½“éªŒã€‚

## âš¡ï¸ æ ¸å¿ƒäº®ç‚¹

*   **æè‡´è½»é‡**: æ¯ä¸ªå­åŒ…éƒ½è¿½æ±‚é›¶ä¾èµ–ï¼Œä½“ç§¯å°å·§ï¼Œæ‹’ç»è‡ƒè‚¿ã€‚
*   **é›¶é…ç½®**: è‡ªåŠ¨è·¯ç”±ã€è‡ªåŠ¨åºåˆ—åŒ–ï¼Œå¼€ç®±å³ç”¨ã€‚
*   **å…¨æ ˆè¦†ç›–**: 
    *   **å®¢æˆ·ç«¯**: æ”¯æŒ å¾®ä¿¡å°ç¨‹åºã€Web (Fetch)ã€Node.jsã€UniApp (è§„åˆ’ä¸­)ã€‚
    *   **æœåŠ¡ç«¯**: æ”¯æŒ å¾®ä¿¡äº‘å¼€å‘ (TCB)ã€è…¾è®¯äº‘å‡½æ•° (SCF)ã€åŸç”Ÿ Node.jsã€é˜¿é‡Œäº‘å‡½æ•° (è§„åˆ’ä¸­)ã€‚
*   **æ™ºèƒ½é‰´æƒ**: å¼ºå¤§çš„ä¸­é—´ä»¶æœºåˆ¶ï¼Œè½»æ¾å¤„ç† Token æ ¡éªŒä¸æ‹¦æˆªã€‚
*   **ç±»å‹å‹å¥½**: è®¾è®¡é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºé…åˆ TypeScript ä½¿ç”¨ã€‚

## ğŸ“¦ ç”Ÿæ€çŸ©é˜µ (Packages)

JS-RPC é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ‚¨å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è‡ªç”±ç»„åˆä½¿ç”¨ã€‚

### ğŸŸ¢ æœåŠ¡ç«¯ (Server)

| åŒ…å | é€‚ç”¨åœºæ™¯ | æè¿° |
| :--- | :--- | :--- |
| **[`rpc-server-tcb`](./packages/rpc-server-tcb)** | å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘ | åˆ©ç”¨äº‘å‡½æ•°åŸç”Ÿèƒ½åŠ›ï¼Œä¸€è¡Œä»£ç å¯åŠ¨ RPC æœåŠ¡ã€‚ |
| **[`rpc-server-scf`](./packages/rpc-server-scf)** | è…¾è®¯äº‘äº‘å‡½æ•° (SCF) | é€‚é… API ç½‘å…³è§¦å‘å™¨ï¼Œå†…ç½®é‰´æƒä¸å“åº”å°è£…ã€‚ |
| **[`rpc-server-node`](./packages/rpc-server-node)** | Node.js åŸç”Ÿ | åŸºäºåŸç”Ÿ HTTP æ¨¡å—ï¼Œæ”¯æŒé™æ€æ‰˜ç®¡ã€CORSï¼Œæ— æ¡†æ¶ä¾èµ–ã€‚ |

### ğŸ”µ å®¢æˆ·ç«¯ (Client)

| åŒ…å | é€‚ç”¨åœºæ™¯ | æè¿° |
| :--- | :--- | :--- |
| **[`rpc-client-tcb`](./packages/rpc-client-tcb)** | å¾®ä¿¡å°ç¨‹åº | åŸºäº `wx.cloud.callFunction`ï¼ŒåŸç”Ÿäº‘å¼€å‘æœ€ä½³æ‹æ¡£ã€‚ |
| **[`rpc-client-fetch`](./packages/rpc-client-fetch)** | Web / Node / RN | åŸºäºæ ‡å‡† `Fetch API`ï¼Œé€šç”¨æ€§å¼ºï¼Œæ”¯æŒåŠ¨æ€ Tokenã€‚ |
| `rpc-client-request` | å°ç¨‹åº / UniApp | (è§„åˆ’ä¸­) åŸºäº `wx.request` æˆ– `uni.request` çš„é€šç”¨å®¢æˆ·ç«¯ã€‚ |

## ğŸš€ å¿«é€Ÿé¢„è§ˆ

### 1. æœåŠ¡ç«¯ä»£ç  (ä»¥ Node.js ä¸ºä¾‹)

åªéœ€åˆ›å»ºä¸€ä¸ª `api` æ–‡ä»¶å¤¹ï¼Œé‡Œé¢çš„æ–‡ä»¶å³ä¸ºæ¨¡å—ã€‚

```javascript
// index.js
const { createRpcServer } = require('rpc-server-node');

// è‡ªåŠ¨å°† ./api ç›®å½•ä¸‹çš„ user.js, order.js ç­‰æ³¨å†Œä¸ºæœåŠ¡
createRpcServer();
```

### 2. å®¢æˆ·ç«¯ä»£ç  (ä»¥ Web ä¸ºä¾‹)

```javascript
import { createRpcClient } from 'rpc-client-fetch';

const rpc = createRpcClient({
  url: 'http://localhost:3000'
});

// âœ¨ é­”æ³•æ—¶åˆ»ï¼šåƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡
const userInfo = await rpc.user.getInfo(1001);
console.log(userInfo);
```

## ğŸ› ï¸ å®‰è£…ä¸ä½¿ç”¨

æœ¬é¡¹ç›®é‡‡ç”¨å¤šåŒ…ç®¡ç†ï¼Œå…·ä½“å®‰è£…å’Œä½¿ç”¨æ–¹å¼è¯·æŸ¥çœ‹å„ä¸ªå­åŒ…çš„ `README` æ–‡æ¡£ã€‚

*   [è¿›å…¥ rpc-server-tcb æ–‡æ¡£](./packages/rpc-server-tcb)
*   [è¿›å…¥ rpc-client-tcb æ–‡æ¡£](./packages/rpc-client-tcb)
*   [è¿›å…¥ rpc-client-fetch æ–‡æ¡£](./packages/rpc-client-fetch)
*   ...

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue æˆ– Pull Request æ¥æ”¹è¿› JS-RPCã€‚

## ğŸ“„ å¼€æºåè®®

MIT License